<div class="container">
  <div class="row">
    <%= render 'public/homes/BRAND', items: @items %>
    <div class="col-4">
      <%= form_with model: @cart_item,url:cart_items_path(@cart_item), local: true do |f| %>
      <%= attachment_image_tag @item, :image, :fill,300,300 %>
    </div>
    <div class="col-6">
      <table class="table table-borderless">
        <tr>
          <th>商品名</th>
          <td><%= @item.name %>
            　<%= f.hidden_field :item_id, :value => @item.id %>
          </td>
        </tr>
        <tr>
          <th>商品説明</th>
          <td><%= @item.introduction %></td>
        </tr>
        <tr>
          <th>お値段</th>
          <td>￥<%= @item. with_tax_price %>(税込)</td>
        </tr>
        <tr>
          <th></th>
          <td><%= f.select :amount, *[1..10],include_blank: "個数選択" %></td>
        </tr>
        <tr>
          <th></th>
          <td><%= f.submit "カートに入れる",class:"btn btn-success" %></td>
        </tr>
      </table>


      <% end %>
      </table>
    </div>
  </div>
  <div class="row">
    <% if @item.favorited_by?(current_customer) %>
    <p>
      <%= link_to item_favorite_path(@item), method: :delete do %>
        ♥<%= @item.favorites.count %> いいね
      <% end %>
    </p>
    <% else %>
    <p>
      <%= link_to item_favorites_path(@item), method: :post do %>
        ♡<%= @item.favorites.count %> いいね
      <% end %>
    </p>
  <% end %>
  </div>
  <div class="row">
  <div>
    <p>コメント件数：<%= @item.post_comments.count %></p>
       <%= @post_comment.comment %>
       <%# if @post_comment.customer == current_customer %>

  <%# end %>
  </div>
<div>
<%= form_with model: @post_comment,url:item_post_comments_path(@item), local: true do |f| %>
  <%= f.text_area :comment, :size=>"50x5",placeholder: "コメントをここに" %>
  <%= f.submit "送信する" %>
<% end %>
</div>
  </div>
  <% @post_comments.each do |post_comment| %>
   <%= post_comment.comment %>
   <%= post_comment.id %>
   <%= link_to "削除", item_post_comment_path(item_id: @item.id, id: post_comment.id), method: :delete %>
  <% end %>
  <div>

    <%#= link_to "削除", item_post_comment_path(post_comment.item, post_comment), method: :delete %>
    <%#= link_to "削除", tweet_comment_path(comment.tweet.id, comment.id), method: :delete %>



  </div>
  <%= form_with model: @review, url:item_reviews_path(@item), local: true do |f| %>
  <%= f.text_area :comment, rows:'5', placeholder: "商品のコメント", class: "form-control form-control-sm" %>
    <div id="rating-form">
        <label>評価：</label>
        <%# scoreNameの値をhidden_fieldでカラムに送っている %>
        <%= f.hidden_field :rate, :value => 'score' %>
    </div>

    <%= f.submit "投稿する" %>
<% end %>

<% @item.reviews.each do |review| %>
 <%# rateを表示 %>
<div class="review-rating" data-score="<%= review.rate %>">評価：</div>

<div class="text-left">
    <p>投稿者：<%= review.customer.last_name %></p>
    <p><%= review.comment %></p>
</div>

<div class="text-right">
    <p>
        投稿日：<%= review.created_at.strftime('%Y/%m/%d') %> |
        <% if review.customer == current_customer %>
            <%= link_to item_reviews_path(review.item, review), method: :delete, class: "btn btn-sm btn-danger" do %>
                コメント削除 <i class="fas fa-trash"></i>
            <% end %>
        <% end %>
    </p>
</div>
<% end %>


<script>
    $('#rating-form').raty({
        starOn: "<%= asset_path('star-on.png') %>",
        starOff: "<%= asset_path('star-off.png') %>",
        scoreName: 'reviews[comment]'
    });
</script>